$.createUploader=function(b){var f=jQuery,e="pending",h,a=0,c=0,d=0,g="/webuploader";var b=f.extend({resize:true,auto:true,swf:g+"/js/Uploader.swf",contextPath:"/dsis",uploaderPath:"/sys/attach/upload",accepts:null,fileNumLimit:undefined,fileSizeLimit:undefined,fileSingleSizeLimit:undefined,picker:"picker",uploaderProgressar:"uploader-progress-bar",chunked:false,chunkSize:5242880,threads:1,fileVal:"file",chunkRetry:3},b||{});if(f("#"+b.picker).length<=0){throw new Error("upload picker is not correct!")}h=WebUploader.create({resize:b.resize,chunked:b.chunked,chunkSize:b.chunSize,threads:b.threads,fileVal:b.fileVal,chunkRetry:b.chunkRetry,auto:b.auto,swf:g+"/js/Uploader.swf",server:b.contextPath+b.uploadPath,pick:"#"+b.picker,accept:b.accepts,fileNumLimit:b.fileNumlimit,fileSizeLimit:b.fileSizeLimit,fileSingleSizeLimit:b.fileSingleSizeLimit});h.on("fileQueued",function(i){a++;d++});h.on("uploadProgress",function(j,i){d--;if(f("#"+b.uploaderProgressar).length>0){if(d>=0){$percent=f("#"+b.uploaderProgressar);c=i*100/a+c;$percent.css("width",c+"%");$percent.find("span").text(c+"% 完成")}}if(d<=0){a=0;c=0}});h.on("uploadSuccess",function(j,i){if(b.uploadSuccess){var k=false;k=b.uploadSuccess(j,i);if(k){h.removeFile(j)}}});h.on("uploadError",function(i){if(b.uploadError){b.uploadError(i)}h.removeFile(i)});h.on("uploadComplete",function(i){if(b.uploadComplete){b.uploadComplete(i)}});h.onError=function(i){if(b.validateError){validateError(i)}};h.on("all",function(i){if(i==="startUpload"){e="uploading"}else{if(i==="stopUpload"){e="paused"}else{if(i==="uploadFinished"){e="done"}}}});return h};